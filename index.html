<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>3è¡Œã‚¢ãƒ—ãƒªé–‹ç™ºãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ</title>
  <link rel="manifest" href="/manifest.webmanifest">
  <meta name="theme-color" content="#1e5eff">
  <style>
    :root{
      --blue:#1e5eff;
      --bg:#f5f7fb;
      --card:#ffffff;
      --text:#0f172a;
      --muted:#64748b;
      --shadow:0 14px 36px rgba(15,23,42,.10);
      --r:18px;
    }
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,"Hiragino Kaku Gothic ProN","Noto Sans JP",sans-serif;background:var(--bg);color:var(--text);}
    header{
      background:radial-gradient(1200px 400px at 20% 20%, rgba(255,255,255,.20), transparent 55%),
                 radial-gradient(900px 380px at 85% 30%, rgba(255,255,255,.16), transparent 55%),
                 linear-gradient(135deg,#1e5eff,#0ea5e9);
      padding:26px 18px 58px;
      color:#fff;
      position:relative;
    }
    .wrap{max-width:1100px;margin:0 auto;}
    .topbar{display:flex;justify-content:space-between;align-items:center;gap:10px}
    .topLeft a{color:#fff;text-decoration:none;font-weight:800;opacity:.95}
    .topLeft a:hover{opacity:1;text-decoration:underline}
    .topRight{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .chip{
      background:rgba(255,255,255,.18);
      border:1px solid rgba(255,255,255,.25);
      color:#fff;
      border-radius:999px;
      padding:10px 14px;
      display:flex;gap:8px;align-items:center;
      backdrop-filter: blur(10px);
      font-weight:800;
    }
    .btn{
      appearance:none;border:0;cursor:pointer;
      border-radius:999px;padding:10px 14px;
      font-weight:900;
      display:flex;gap:8px;align-items:center;
    }
    .btnLight{background:rgba(255,255,255,.18);border:1px solid rgba(255,255,255,.25);color:#fff}
    .btnDanger{background:#ff4d4f;color:#fff}
    .btnDanger:hover{filter:brightness(.95)}
    header h1{margin:16px 0 6px;font-size:44px;letter-spacing:.5px}
    header p{margin:0;opacity:.92}

    main{max-width:1100px;margin:-36px auto 40px;padding:0 18px;}
    .panel{background:var(--card);border-radius:var(--r);box-shadow:var(--shadow);padding:22px;}
    .panel h2{margin:0 0 2px;font-size:22px}
    .panel .sub{color:var(--muted);margin:0 0 14px;font-size:13px}

    .grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:14px}
    @media (max-width:860px){.grid{grid-template-columns:1fr}}
    .card{
      background:#fff;border:1px solid #e8eef7;border-radius:16px;
      padding:16px;display:flex;gap:14px;align-items:flex-start;
      box-shadow:0 10px 24px rgba(15,23,42,.06);
      transition:transform .08s ease, box-shadow .12s ease;
      cursor:pointer;
      text-decoration:none;
      color:inherit;
    }
    .card:hover{transform:translateY(-1px);box-shadow:0 14px 32px rgba(15,23,42,.10)}
    .icon{
      width:44px;height:44px;border-radius:14px;
      background:linear-gradient(135deg,#e0f2fe,#eef2ff);
      display:flex;align-items:center;justify-content:center;
      border:1px solid #e6eef9;
      flex:0 0 auto;
    }
    .title{font-weight:900;font-size:18px;margin:0}
    .desc{margin:6px 0 0;color:var(--muted);line-height:1.55}

    .hidden{display:none!important}
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <div class="topbar">
        <div class="topLeft">
          <a href="/index.html">â† ãƒ¡ãƒ‹ãƒ¥ãƒ¼</a>
        </div>
        <div class="topRight">
          <div id="chipUser" class="chip">æœªãƒ­ã‚°ã‚¤ãƒ³</div>
          <button id="btnAccount" class="btn btnLight" type="button">ğŸ‘¤ ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ</button>
          <button id="btnLogout" class="btn btnDanger" type="button">â» Logout</button>
        </div>
      </div>

      <h1>3è¡Œã‚¢ãƒ—ãƒªé–‹ç™ºãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ</h1>
      <p>æˆæ¥­å†…å®¹ã‚’ã€Œ3è¡Œã€ã§æŒ¯ã‚Šè¿”ã‚‹å­¦ç¿’æ”¯æ´ã‚¢ãƒ—ãƒª</p>
    </div>
  </header>

  <main>
    <div class="panel">
      <h2>ãƒ¡ãƒ‹ãƒ¥ãƒ¼</h2>
      <p class="sub">ä½¿ã„ãŸã„æ©Ÿèƒ½ã‚’é¸ã‚“ã§ãã ã•ã„</p>

      <div class="grid">
        <a class="card" href="/posts">
          <div class="icon">ğŸ“</div>
          <div>
            <p class="title">3è¡ŒæŠ•ç¨¿</p>
            <p class="desc">æˆæ¥­ã®è¦ç‚¹ã‚’3è¡Œã§æŠ•ç¨¿ã€‚å…ˆç”Ÿã®ã€Œã„ã„ã­ãƒ»ã‚³ãƒ¡ãƒ³ãƒˆã€ã‚‚ç¢ºèªã§ãã¾ã™ã€‚</p>
          </div>
        </a>

        <a class="card" href="/questions">
          <div class="icon">ğŸ’¬</div>
          <div>
            <p class="title">è³ªå•æ²ç¤ºæ¿</p>
            <p class="desc">æˆæ¥­ä¸­ãƒ»å¾Œã®ç–‘å•ã‚’æŠ•ç¨¿ã€‚å­¦ç”Ÿ/æ•™å“¡ãŒå›ç­”ã—ã¦å­¦ã³åˆã„ã€‚</p>
          </div>
        </a>

        <a class="card" href="/quizzes">
          <div class="icon">ğŸ§ </div>
          <div>
            <p class="title">ã‚¯ã‚¤ã‚º</p>
            <p class="desc">æŠ•ç¨¿å†…å®¹ã‹ã‚‰ã€Œæ€ã„å‡ºã—ã‚¯ã‚¤ã‚ºã€ã‚’è¡¨ç¤ºã€‚å¾©ç¿’ã«ä½¿ãˆã¾ã™ã€‚</p>
          </div>
        </a>

        <a class="card" href="/reminders">
          <div class="icon">â°</div>
          <div>
            <p class="title">å¾©ç¿’ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼</p>
            <p class="desc">æˆæ¥­å¾Œã®å¾©ç¿’ã‚’ç¿’æ…£åŒ–ã€‚æœŸé™ãŒæ¥ãŸå†…å®¹ã‚’ç¢ºèªã§ãã¾ã™ã€‚</p>
          </div>
        </a>

        <a class="card" href="/ranking">
          <div class="icon">ğŸ†</div>
          <div>
            <p class="title">ãƒ©ãƒ³ã‚­ãƒ³ã‚°</p>
            <p class="desc">æŠ•ç¨¿ãƒ»å›ç­”ãªã©ã®è²¢çŒ®åº¦ã‚’è¡¨ç¤ºï¼ˆè¨­å®šã§éè¡¨ç¤ºã«ã‚‚ã§ãã¾ã™ï¼‰ã€‚</p>
          </div>
        </a>

        <a class="card" href="/settings">
          <div class="icon">âš™ï¸</div>
          <div>
            <p class="title">è¨­å®š</p>
            <p class="desc">è¡¨ç¤ºã‚„å‹•ä½œã®è¨­å®šï¼ˆãƒ©ãƒ³ã‚­ãƒ³ã‚°éè¡¨ç¤ºãªã©ï¼‰ã€‚</p>
          </div>
        </a>
      </div>
    </div>
  </main>

  <script>
    const $ = (id)=>document.getElementById(id);

    async function api(path, opt={}) {
      const res = await fetch(path, { cache:"no-store", credentials:"include", ...opt });
      const json = await res.json().catch(()=>null);
      return { res, json };
    }

    async function loadMeOrRedirect() {
      const r = await api("/api/auth/me");
      if (!r.json || !r.json.ok || !r.json.user) {
        location.replace("/login");
        return;
      }
      const u = r.json.user;
      $("chipUser").textContent = `ãƒ­ã‚°ã‚¤ãƒ³ï¼š${u.display_name}ï¼ˆ${u.username}ï¼‰ role=${u.role}`;
    }

    async function doLogout() {
      try{
        await api("/api/auth/logout", { method:"POST" });
      }catch(_){}
      location.replace("/login");
    }

    $("btnAccount").addEventListener("click", ()=>location.href="/account");
    $("btnLogout").addEventListener("click", doLogout);

    loadMeOrRedirect();
  </script>
</body>
</html>
