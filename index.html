<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>3è¡Œã‚¢ãƒ—ãƒªé–‹ç™ºãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ</title>
  <style>
    :root{
      --blue:#2563eb;--blue2:#1d4ed8;--bg:#eef3ff;--card:#fff;--text:#0f172a;--muted:#64748b;
      --line:#e5e7eb;
    }
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans JP","Hiragino Kaku Gothic ProN","Yu Gothic",sans-serif;
      background:var(--bg);color:var(--text);
    }

    /* ===== Headerï¼šç¼©å°å ç”¨ç©ºé—´ ===== */
    header{
      background:linear-gradient(135deg,var(--blue),var(--blue2));
      color:#fff;
      padding:28px 28px 30px; /* â†“ åŸæ¥ 44px 28px */
      position:relative;
      overflow:hidden;
    }
    header:before{
      content:"";
      position:absolute;inset:-30px;opacity:.18;background:
        radial-gradient(circle at 20% 30%, #fff 0 120px, transparent 121px),
        radial-gradient(circle at 80% 20%, #fff 0 180px, transparent 181px);
    }

    header .topbar{
      display:flex;align-items:center;justify-content:flex-end;gap:10px;
      position:relative;z-index:1;
      margin-bottom:10px;
    }
    .btn{border:0;border-radius:14px;padding:9px 14px;font-weight:700;cursor:pointer;} /* è½»å¾®ç¼©å° */
    .btnGhost{background:rgba(255,255,255,.18);color:#fff;}
    .btnDanger{background:#ef4444;color:#fff;}

    header h1{
      margin:8px 0 6px;         /* â†“ åŸæ¥ 22px 0 8px */
      font-size:34px;           /* â†“ åŸæ¥ 44px */
      letter-spacing:.02em;
      position:relative;z-index:1;
    }
    header p{
      margin:0;
      font-size:14px;           /* â†“ æ›´ç´§å‡‘ */
      color:rgba(255,255,255,.9);
      position:relative;z-index:1;
    }

    main{max-width:1100px;margin:0 auto;padding:22px;}
    .wrap{
      background:rgba(255,255,255,.6);
      backdrop-filter: blur(6px);
      border:1px solid rgba(255,255,255,.6);
      border-radius:22px;
      padding:18px;
      box-shadow:0 18px 40px rgba(2,6,23,.08);
      margin-top:-26px;         /* â†“ åŸæ¥ -38pxï¼Œé…åˆ header å˜çŸ® */
    }

    /* ===== Grid ===== */
    .grid{
      display:grid;
      grid-template-columns:repeat(12,1fr);
      gap:14px;
      align-items:stretch;
    }
    @media (max-width: 980px){
      .grid{grid-template-columns:repeat(6,1fr);}
    }
    @media (max-width: 640px){
      .grid{grid-template-columns:repeat(1,1fr);}
    }

    /* ===== Small tile (existing) ===== */
    .tile{
      grid-column: span 4;
      display:flex;gap:14px;align-items:flex-start;
      background:var(--card);
      border:1px solid var(--line);
      border-radius:18px;
      padding:16px;
      text-decoration:none;
      color:inherit;
      box-shadow:0 10px 26px rgba(2,6,23,.06);
      transition: transform .12s ease, box-shadow .12s ease, border-color .12s ease;
    }
    .tile:hover{
      transform: translateY(-2px);
      box-shadow:0 16px 34px rgba(2,6,23,.10);
      border-color:#d7dde6;
    }
    .ico{
      width:44px;height:44px;border-radius:14px;background:#eef2ff;
      display:flex;align-items:center;justify-content:center;font-size:22px;flex:0 0 44px;
    }
    .t{font-weight:900;margin-bottom:4px}
    .d{color:var(--muted);font-size:14px;line-height:1.5}

    /* ===== Big cover cards (NotebookLM-ish) ===== */
    .heroCard{
      grid-column: span 6;   /* 2 cards per row on 12-col grid */
      display:flex;
      flex-direction:column;
      background:var(--card);
      border:1px solid var(--line);
      border-radius:20px;
      overflow:hidden;
      text-decoration:none;
      color:inherit;
      box-shadow:0 14px 34px rgba(2,6,23,.08);
      transition: transform .12s ease, box-shadow .12s ease, border-color .12s ease;
      min-height: 240px;     /* â†“ åŸæ¥ 260pxï¼Œç¨å¾®çœç©ºé—´ */
    }
    .heroCard:hover{
      transform: translateY(-2px);
      box-shadow:0 18px 44px rgba(2,6,23,.12);
      border-color:#d7dde6;
    }
    @media (max-width: 980px){
      .heroCard{grid-column: span 6;}
    }
    @media (max-width: 640px){
      .heroCard{grid-column: span 1;}
    }

    .cover{
      height:130px;          /* â†“ åŸæ¥ 140px */
      position:relative;
      overflow:hidden;
    }
    /* abstract â€œimageâ€ backgrounds */
    .cover.posts{
      background:
        radial-gradient(circle at 25% 30%, rgba(255,255,255,.75) 0 60px, transparent 61px),
        radial-gradient(circle at 70% 20%, rgba(255,255,255,.55) 0 90px, transparent 91px),
        linear-gradient(135deg, #4f46e5 0%, #2563eb 55%, #06b6d4 110%);
    }
    .cover.questions{
      background:
        radial-gradient(circle at 20% 70%, rgba(255,255,255,.65) 0 70px, transparent 71px),
        radial-gradient(circle at 80% 35%, rgba(255,255,255,.55) 0 110px, transparent 111px),
        linear-gradient(135deg, #0ea5e9 0%, #2563eb 55%, #9333ea 120%);
    }

    .coverBadge{
      position:absolute;left:14px;bottom:12px;
      display:flex;align-items:center;gap:12px;
      color:#fff;
      text-shadow:0 6px 18px rgba(0,0,0,.35);
    }

    /* ===== å…³é”®ï¼šå¤§å›¾æ ‡ ===== */
    .coverIcon{
      width:64px;height:64px;          /* â†‘ åŸæ¥ 42x42 */
      border-radius:20px;              /* æ›´å¤§æ›´åœ†æ¶¦ */
      display:flex;align-items:center;justify-content:center;
      background:rgba(255,255,255,.18);
      border:1px solid rgba(255,255,255,.25);
      backdrop-filter: blur(8px);
      font-size:34px;                  /* â†‘ åŸæ¥ 20px */
      box-shadow:0 10px 26px rgba(0,0,0,.16);
    }

    .coverTitle{
      font-size:22px;                  /* â†‘ ç•¥å¤§æ›´åŒ¹é… */
      font-weight:900;
      letter-spacing:.02em;
      line-height:1.1;
    }
    .coverSub{
      font-size:12px;
      opacity:.95;
      margin-top:4px;
    }

    .heroBody{
      padding:14px 16px 16px;
      display:flex;
      gap:10px;
      flex-direction:column;
      flex:1;
      justify-content:space-between;
    }
    .heroDesc{
      color:var(--muted);
      font-size:14px;
      line-height:1.6;
      margin:0;
    }
    .heroCTA{
      display:flex;align-items:center;justify-content:space-between;gap:10px;
      margin-top:10px;
      color:#111827;
      font-weight:800;
      font-size:14px;
    }
    .pill{
      display:inline-flex;align-items:center;gap:6px;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid #e6e9f2;
      background:#f8fafc;
      color:#0f172a;
      font-weight:800;
      font-size:13px;
    }

    .meta{
      margin-top:6px;                  /* â†“ åŸæ¥ 10px */
      color:rgba(255,255,255,.88);
      font-size:13px;                  /* â†“ åŸæ¥ 14px */
      position:relative;z-index:1;
    }
    .meta span{opacity:.95}
    .hidden{display:none}

    /* ===== ã‚¯ã‚¤ã‚ºåˆ†ç»„ ===== */
    .group {
      grid-column: span 4;
      border:2px dashed #c7d2fe;
      border-radius:20px;
      padding:14px;
      background:rgba(255,255,255,.75);
    }
    .group-title {
      font-weight:900;
      color:#3730a3;
      margin-bottom:10px;
      display:flex;
      align-items:center;
      gap:8px;
    }
    .group-grid {
      display:grid;
      grid-template-columns:1fr;
      gap:12px;
    }
    /* group å†…éƒ¨ tile ä¸è¦å†å  12-grid çš„ span */
    .group .tile{ grid-column: auto; }

    /* å°å±æ—¶ group ä¹Ÿå˜å…¨å®½ */
    @media (max-width: 980px){
      .tile{grid-column: span 6;}
      .group{grid-column: span 6;}
    }
    @media (max-width: 640px){
      .tile{grid-column: span 1;}
      .group{grid-column: span 1;}
    }
  </style>
</head>
<body>

<header>
  <div class="topbar">
    <button id="btnMenu" class="btn btnGhost">ğŸ  ãƒ¡ãƒ‹ãƒ¥ãƒ¼</button>
    <button id="btnAccount" class="btn btnGhost">ğŸ‘¤ ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ</button>
    <button id="btnLogout" class="btn btnDanger">ğŸš« Logout</button>
  </div>

  <h1>3è¡Œã‚¢ãƒ—ãƒªé–‹ç™ºãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ</h1>
  <p>æˆæ¥­å†…å®¹ã‚’ã€Œ3è¡Œã€ã§æŒ¯ã‚Šè¿”ã‚‹å­¦ç¿’æ”¯æ´ã‚¢ãƒ—ãƒª</p>
  <div id="loginMeta" class="meta hidden">
    ãƒ­ã‚°ã‚¤ãƒ³ï¼š<span id="metaName"></span>ï¼ˆ<span id="metaUser"></span>ï¼‰
  </div>
</header>

<main>
  <div class="wrap">
    <div class="grid">

      <!-- âœ… NotebookLM-ish big cover card: 3è¡ŒæŠ•ç¨¿ -->
      <a class="heroCard" href="/posts.html">
        <div class="cover posts">
          <div class="coverBadge">
            <div class="coverIcon">ğŸ“</div>
            <div>
              <div class="coverTitle">3è¡ŒæŠ•ç¨¿</div>
              <div class="coverSub">æˆæ¥­ã®è¦ç‚¹ã‚’ã€Œ3è¡Œã€ã§å®šç€</div>
            </div>
          </div>
        </div>
        <div class="heroBody">
          <p class="heroDesc">
            æˆæ¥­ã®è¦ç‚¹ã‚’3è¡Œã§æŠ•ç¨¿ã€‚å…ˆç”Ÿã®ã€Œã„ã„ã­ãƒ»ã‚³ãƒ¡ãƒ³ãƒˆã€ã‚‚ç¢ºèªã§ãã¾ã™ã€‚
          </p>
          <div class="heroCTA">
            <span class="pill">ã™ãæŠ•ç¨¿ã™ã‚‹</span>
            <span>â†’</span>
          </div>
        </div>
      </a>

      <!-- âœ… NotebookLM-ish big cover card: è³ªå•æ²ç¤ºæ¿ -->
      <a class="heroCard" href="/questions.html">
        <div class="cover questions">
          <div class="coverBadge">
            <div class="coverIcon">ğŸ’¬</div>
            <div>
              <div class="coverTitle">è³ªå•æ²ç¤ºæ¿</div>
              <div class="coverSub">ç–‘å•ã‚’æ®‹ã•ãšè§£æ¶ˆ</div>
            </div>
          </div>
        </div>
        <div class="heroBody">
          <p class="heroDesc">
            æˆæ¥­ä¸­ãƒ»å¾Œã®ç–‘å•ã‚’æŠ•ç¨¿ã€‚å­¦ç”Ÿ/æ•™å“¡ãŒå›ç­”ã—ã¦å­¦ã³åˆã„ã€‚
          </p>
          <div class="heroCTA">
            <span class="pill">è³ªå•ã‚’è¦‹ã‚‹</span>
            <span>â†’</span>
          </div>
        </div>
      </a>

      <!-- ===== ã‚¯ã‚¤ã‚º åˆ†ç»„ï¼ˆä¿æŒä½ ç°æœ‰é€»è¾‘ï¼‰ ===== -->
      <div class="group">
        <div class="group-title">ğŸ§© ã‚¯ã‚¤ã‚º</div>
        <div class="group-grid">
          <a class="tile" href="/quiz.html">
            <div class="ico">ğŸ§©</div>
            <div>
              <div class="t">ã‚¯ã‚¤ã‚º</div>
              <div class="d">æŠ•ç¨¿å†…å®¹ã‹ã‚‰ã€Œæ€ã„å‡ºã—ã‚¯ã‚¤ã‚ºã€ã‚’è¡¨ç¤ºã€‚å¾©ç¿’ã«ä½¿ãˆã¾ã™ã€‚</div>
            </div>
          </a>

          <a id="tileQuizAdmin" class="tile hidden" href="/quiz_admin.html">
            <div class="ico">ğŸ› ï¸</div>
            <div>
              <div class="t">ã‚¯ã‚¤ã‚ºç®¡ç†</div>
              <div class="d">ã‚¯ã‚¤ã‚ºã®ç”Ÿæˆãƒ»ç·¨é›†ãƒ»å…¬é–‹ï¼ˆæ•™å“¡/ç®¡ç†è€…ã®ã¿ï¼‰ã€‚</div>
            </div>
          </a>
        </div>
      </div>

      <!-- âœ… ä¸‹é¢è¿™äº›ä¿æŒåŸæ ·ï¼šå¤ä¹ /æ’å/è®¾ç½® éƒ½åœ¨ -->
      <a class="tile" href="/reminders.html">
        <div class="ico">â°</div>
        <div>
          <div class="t">å¾©ç¿’ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼</div>
          <div class="d">æˆæ¥­å¾Œã®å¾©ç¿’ã‚’ç¿’æ…£åŒ–ã€‚æœŸé™ãŒæ¥ãŸå†…å®¹ã‚’ç¢ºèªã§ãã¾ã™ã€‚</div>
        </div>
      </a>

      <a class="tile" href="/ranking.html">
        <div class="ico">ğŸ†</div>
        <div>
          <div class="t">ãƒ©ãƒ³ã‚­ãƒ³ã‚°</div>
          <div class="d">æŠ•ç¨¿ãƒ»å›ç­”ãªã©ã®è²¢çŒ®åº¦ã‚’è¡¨ç¤ºï¼ˆè¨­å®šã§éè¡¨ç¤ºã«ã‚‚ã§ãã¾ã™ï¼‰ã€‚</div>
        </div>
      </a>

      <a class="tile" href="/settings.html">
        <div class="ico">âš™ï¸</div>
        <div>
          <div class="t">è¨­å®š</div>
          <div class="d">è¡¨ç¤ºã‚„å‹•ä½œã®è¨­å®šï¼ˆãƒ©ãƒ³ã‚­ãƒ³ã‚°éè¡¨ç¤ºãªã©ï¼‰ã€‚</div>
        </div>
      </a>

    </div>
  </div>
</main>

<script>
  async function apiGet(path){
    const res = await fetch(path, { credentials:"include", cache:"no-store" });
    const data = await res.json().catch(()=>null);
    return { ok: res.ok, data };
  }
  async function apiPost(path, body){
    const res = await fetch(path, {
      method:"POST",
      headers:{ "Content-Type":"application/json" },
      credentials:"include",
      body:JSON.stringify(body||{})
    });
    return res;
  }
  function isTeacherOrAdmin(u){
    return u && (u.role === "admin" || u.role === "teacher");
  }

  (async ()=>{
    const r = await apiGet("/api/auth/me?ts="+Date.now());
    if (!r.ok || !r.data?.ok) {
      location.replace("/login");
      return;
    }
    const u = r.data.user;
    metaName.textContent = u.display_name || u.username;
    metaUser.textContent = u.username;
    loginMeta.classList.remove("hidden");

    if (isTeacherOrAdmin(u)) {
      document.getElementById("tileQuizAdmin").classList.remove("hidden");
    }
  })();

  btnLogout.onclick = async ()=>{
    await apiPost("/api/auth/logout",{});
    location.replace("/login");
  };
  btnAccount.onclick = ()=>location.href="/account.html";
  btnMenu.onclick = ()=>location.href="/index.html";
</script>

</body>
</html>
